{{extend 'layout.html'}}
{{block head}}

<meta charset="UTF-8">

    <!-- Para los mensajes con flash -->
    <link rel="stylesheet" href="{{=URL('static','css/web2py-bootstrap3-flash.css')}}"/>

    <!-- Estilos de modales y listados -->
      <!-- Estilo del listado de Solicitudes de Servicios -->
    <link rel="stylesheet" href="{{=URL('static', 'css/servicios_solicitud.css')}}">
    <link rel="stylesheet" href="{{=URL('static', 'css/servicios_modal.css')}}">
    <link rel="stylesheet" href="{{=URL('static', 'inventarios/css/template_modal.css')}}">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <script src="{{=URL('static', 'js/inventario_template_modal.js')}}"></script>   
    <!-- Web2py JS - Especialmente para AJAX -->
    <script src="{{=URL('static', 'js/web2py.js')}}"></script>
    <style>
    .row{
        margin-right:0px!important;
    }
     </style>

<style type="text/css">

    .wrapper {
    max-width: 1000px;
    margin: auto;
    margin-top: 0;
    }

    .tab-wrapper {
    text-align: center;
    display: block;
    margin: auto;
    max-width: 400px;
    }

    .tabs {
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    }

    .tab-link {
    margin: 0 1%;
    list-style: none;
    padding: 10px 20px;
    color: #aaa;
    cursor: pointer;
    font-weight: 700;
    transition: all ease 0.5s;
    border-bottom: solid 3px rgba(255, 255, 255, 0);
    letter-spacing: 1px;
    }

    .tab-link:hover {
    color: #999;
    border-color: #999;
    }

    .tab-link.active {
    color: #333;
    border-color: #333;
    }

    .tab-link:nth-of-type(1).active {
    color: #1790D2;
    border-color: #1790D2
    }

    .tab-link:nth-of-type(2).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .tab-link:nth-of-type(4).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .tab-link:nth-of-type(5).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .tab-link:nth-of-type(6).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .tab-link:nth-of-type(7).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .tab-link:nth-of-type(3).active {
    color: #1790D2;
    border-color: #1790D2;
    }

    .content-wrapper {
    padding: 20px 80px;
    }

    .tab-content {
    display: none;
    text-align: left;
    color:  #464646;
    font-weight: 200;
    font-size: 20px;
    opacity: 0;
    transform: translateY(15px);
    animation: fadeIn 0.5s ease 1 forwards;
    }

    .tab-content.active {
    display: block;
    }

    @keyframes fadeIn {
    100% {
        opacity: 1;
        transform: none;
    }
}
</style>
<link rel="stylesheet" href="{{=URL('static', 'css/smydp_inventarios.css')}}">
<link rel="stylesheet" href="{{=URL('static', 'inventarios/css/detalles_bm.css')}}">	  
{{end}}

{{block center}}
    <h3 class="dep-titulo text-center">Detalles de {{=bien['bm_nombre']}}</h3>
    <h4 class="dep-titulo text-center">N/B: {{=bien['bm_num']}}</h4>
    {{ if bien['bm_placa'] != '': }}
        <h4 class="dep-titulo text-center">Placa: {{=bien['bm_placa']}}</h4>
    {{pass}}
    <!-- Flash message -->
    <div class="w2p_flash alert alert-dismissable">{{=response.flash or ''}}</div>
{{pass}}

<!-- Inicio Boton Modificar BM -->
<div class="container" id="containerAgregar">
    <div class="row">
        <div class="col-sm-6"></div>
        <div id="columnBotonAgregar" class="col-sm-6">
            <div class="col-sm-6"></div>
            <div class="col-sm-6">
                <!-- Boton que lleva al modal --> <!-- Cambiar data-target="#addservice por el id de la forma de la sustancia -->
                <button type="button" data-toggle="modal" data-target="#addbm" onclick="select_values()"><i class="fas fa-pencil-alt fa-1x"></i></button>
                <!-- Boton para eliminar bien mueble-->
                <button type="button" data-toggle="modal" data-target="#confirmdelete"><i class="fas fa-trash fa-1x"></i></button>
                <!--Boton para ocultar el bien mueble-->
                <button type="button" data-toggle="modal" data-target="#confirmhide"><i class="fas fa-eye-slash fa-1x"></i></button>
            </div>
        </div>
    </div>
</div>
<!-- Fin Boton Agregar Sustancia -->

<div class="wrapper">
		
	<div class="tab-wrapper">
		<ul class="tabs">
				<li class="tab-link active" data-tab="1">CARACTERÍSTICAS</li>
				<li class="tab-link" data-tab="2">SUDEBID</li>
                <li class="tab-link" data-tab="3">UBICACIÓN</li>
                <li class="tab-link" data-tab="4">HISTORIAL DE MANTENIMIENTO</li>
            </ul>
	</div>

	<div class="content-wrapper">
		<div id="tab-1" class="tab-content active">
            <div class="grid-container">
                {{ for title in caracteristicas_list: }}
                    <div class="grid-item">
                        {{=title}}
                    </div>
                    <div class="grid-item">
                        {{ if title == "Uso:": }}
                            {{ if (caracteristicas_dict.get(title).find("Docencia")) != -1:}}
                                Docencia<br>
                            {{pass}}
                            {{if (caracteristicas_dict.get(title).find("Investigaci")) != -1:}}
                                Investigación<br>
                            {{pass}}
                            {{if (caracteristicas_dict.get(title).find("Extensi")) != -1:}}
                                Extensión<br>
                            {{pass}}
                            {{if (caracteristicas_dict.get(title).find("Apoyo administrativo")) != -1:}}
                                Apoyo administrativo<br>
                            {{pass}}
                        {{ else: }}
                            {{= caracteristicas_dict.get(title)}}
                        {{pass}}
                    </div>
                {{ pass }}
                {{if bien['bm_ancho'] != None or bien['bm_largo'] != None or bien['bm_alto'] != None or bien['bm_diametro'] != None:}}
                    <div class="grid-item">
                        {{ if bien['bm_unidad'] == 'm':}}
                            Dimensiones (metros):
                        {{else:}}
                            Dimensiones (centímetros):
                        {{pass}}
                    </div>
                    <div class="grid-item">                        
                        {{if bien['bm_ancho'] != None:}}
                            Ancho: {{=bien['bm_ancho']}}
                            <br>
                        {{pass}}
                        {{if bien['bm_largo'] != None:}}
                            Largo: {{=bien['bm_largo']}}
                            <br>
                        {{pass}}
                        {{if bien['bm_alto'] != None:}}
                            Alto: {{=bien['bm_alto']}}
                            <br>
                        {{pass}}
                        {{if bien['bm_diametro'] != None:}}
                            Diámetro: {{=bien['bm_diametro']}}
                            <br>
                        {{pass}}
                    </div>
                {{pass}}
            </div>
        </div>

        <!-- Pensar utilizar grid-->
		<div id="tab-2" class="tab-content">
            <div class="grid-container">
            {{ for title in sudebid_list: }}
                <div class="grid-item">
                    {{=title}}
                </div>
                <div class="grid-item">
                    {{= sudebid_dict.get(title)}}
                </div>
            {{ pass }}
            </div>
        </div>
        <div id="tab-3"class="tab-content">
            <div class="grid-container">
                <div class="grid-item">
                    Espacio físico:
                </div>
                <div class="grid-item">
                    {{=db(db.espacios_fisicos.id == bien['bm_espacio_fisico']).select().first().codigo}}
                </div>
                <div class="grid-item">
                    Unidad de Adscripción:
                </div>
                <div class="grid-item">
                    {{=bien['bm_unidad_de_adscripcion']}}
                </div>
                <div class="grid-item">
                    Dependencia:
                </div>
                <div class=grid-item>
                    {{=db(db.dependencias.id == bien['bm_depedencia']).select().first().nombre}}
                </div>
            </div>
        </div>
        <div id="tab-4"class="tab-content">En Desarrollo</div>
    </div>
	
</div>

<!--Modal para eliminar bm-->
<div class="modal fade" id="confirmdelete" role="dialog">
    <div class="modal-dialog">
  
      <!-- Modal content-->
      <div class="modal-content">
  
        <!-- Modal Header -->
        <div class="modal-header addHeader">
          <div class="row addRow" id="rowHeader">
            <div class="col-sm-1" id="col1Header" style="background-color: red;">
              <div class="container">
                  <i class="fas fa-trash fa-2x" style="
                  display:block;
                  margin-left: -16px;
                  margin-top: 8px;
                  color: white;
                  "></i>
              </div>
            </div>
            <div class="col-sm-11" id="col11Header" style="background-color: red;">
              <h4 class="modal-title" id="nuevaBien" style="
                text-align: left;
                padding-top: 12px;
                color: white;
              ">Confirmar eliminación<button type="button" class="close" data-dismiss="modal">&times;</button>
              </h4>
            </div>
          </div>
        </div>
        <!-- Fin Modal Header -->
        
        <!-- Modal Body -->
        <div class="modal-body addBody">
            <br>
            <form method="post" style="text-align: center;">
                <h4>¿Desea solicitar la eliminación de {{=bien['bm_nombre']}}?</h4>
                <br>
                <button type="submit button" class="btn btn-next botondelete" name="eliminacion" value="True" style="text-align:center">Si</button>
                <button type="button" class="btn btn-next botonForm" style="text-align:center" data-dismiss="modal">No</button>
            </form>
            <br>
        </div>
      </div>
    </div>
</div>

<!--Modal para oculta BM-->
<div class="modal fade" id="confirmhide" role="dialog">
        <div class="modal-dialog">
      
          <!-- Modal content-->
          <div class="modal-content">
      
            <!-- Modal Header -->
            <div class="modal-header addHeader">
              <div class="row addRow" id="rowHeader">
                <div class="col-sm-1" id="col1Header">
                  <div class="container">
                      <i class="fas fa-eye-slash fa-2x" style="
                      display:block;
                      margin-left: -19px;
                      margin-top: 12px;
                      color: white;
                      "></i>
                  </div>
                </div>
                <div class="col-sm-11" id="col11Header">
                  <h4 class="modal-title" id="nuevaBien" style="
                    text-align: left;
                    padding-top: 12px;
                    color: white;
                  ">Confirmar ocultar<button type="button" class="close" data-dismiss="modal">&times;</button>
                  </h4>
                </div>
              </div>
            </div>
            <!-- Fin Modal Header -->
            
            <!-- Modal Body -->
            <div class="modal-body addBody">
                <br>
                <form method="post" style="text-align: center;">
                    <h4>¿Desea ocultar {{=bien['bm_nombre']}} de las consultas?</h4>
                    <br>
                    <button type="submit button" class="btn btn-next botondelete" name="ocultar" value="True" style="text-align:center">Si</button>
                    <button type="button" class="btn btn-next botonForm" style="text-align:center" data-dismiss="modal">No</button>
                </form>
                <br>
            </div>
          </div>
        </div>
    </div>

<!-- Modal añadir un BM nuevo al inventario -->
<div class="modal fade" id="addbm" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header addHeader">
        <div class="row addRow" id="rowHeader">
          <div class="col-sm-1" id="col1Header">
            <div class="container">
                <i class="fas fa-pencil-alt fa-2x" style="
                display:block;
                margin-left: -16px;
                margin-top: 8px;
                "></i>
            </div>
          </div>
          <div class="col-sm-11" id="col11Header">
            <h4 class="modal-title" id="nuevaBien" style="
              text-align: left;
              padding-top: 12px;
              color: white;
            ">Modificar Bien Mueble<button type="button" class="close" data-dismiss="modal">&times;</button>
            </h4>
          </div>
        </div>
      </div>
      <!-- Fin Modal Header -->
      
      <!-- Modal Body -->
      <div class="modal-body addBody">
        <div class="row addRow">
          <div class="col-md-12 form-box">
              <form id="formularioCarga" class="registration-form" method="post" onsubmit="return validar_campos()">
 
                <!-- Primer paso-->
                <fieldset class="formField">
                  <div class="form-bottom" data-step="2" data-title="Segundo Paso">
                    <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                    <div class="col-sm-1 col1Body"> 
                      <span class="step activePass">1</span>
                      <span class="step">2</span>
                      <span class="step">3</span>
                    </div>
                    <!-- Aqui va la informacion -->
                    <div class="col-sm-11 col11Body">
                      <h4 class="titulosForm">Características del Bien</h4>                
                      <label>Campos marcados con * son obligatorios.</label>


                        <div class="form-group" tag="Formato:">
                            <input type="text" class="form-control" id="nombre" name="nombre" title="Ingrese el nombre del Bien Mueble" placeholder="Nombre*" value="{{=bien['bm_nombre']}}" required>
                            <div class="field-error"> <p id="error-nombre"> </p> </div>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="no_bien" name="no_bien" placeholder="Número de Bien Nacional*" title="Formato: ###### (6 dígitos)" value="{{=bien['bm_num']}}" readonly required>
                            <font color="red"><div id="err_no_bien" hidden></div></font>
                        </div>

                        <div class="form-group">
                            {{if bien['bm_placa']=="":}}
                                <input type="text" class="form-control" id="no_placa" name="no_placa" title="Formato: ##### (5 dígitos)" placeholder="N° de placa">
                            {{else:}}
                                <input type="text" class="form-control" id="no_placa" name="no_placa" title="Formato: ##### (5 dígitos)" value="{{=bien['bm_placa']}}" placeholder="N° de placa">
                            {{pass}}
                            <font color="red"><div id="err_placa" hidden></div></font>
                        </div>

                        {{if bien['bm_marca']!="":}}
                        <div class="form-group">
                            <input type="text" class="form-control" value="{{=bien['bm_marca']}}" id="marca" name="marca" placeholder="Marca*" required >
                            <div class="field-error"> <p id="error-marca"> </p> </div>
                        </div>
                        {{pass}}

                        {{if bien['bm_modelo']!="":}}
                        <div class="form-group">
                                <input type="text" class="form-control" id="modelo" value="{{=bien['bm_modelo']}}" name="modelo" value="" placeholder="Modelo*" required>
                                <div class="field-error"> <p id="error-modelo"> </p> </div>
                            
                        </div>
                        {{pass}}

                        {{if bien['bm_serial']!="":}}
                        <div class="form-group">
                            <input type="text" class="form-control" id="serial" value="{{=bien['bm_serial']}}" name="serial" placeholder="Serial*" required>
                            <div class="field-error"> <p id="error-serial"> </p> </div>
                          </div>
                        {{pass}}

                          <div class="form-group">
                            <input type="text" class="form-control" id="Descripcion" value="{{=bien['bm_descripcion']}}" name="descripcion" placeholder="Descripción*" required>
                            <div class="field-error"> <p id="error-est-descripcion"> </p> </div>
                        </div>
                        
                    </div>
                  </div>
                  <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>         
                </fieldset>
                <!-- Fin Primer Paso -->

                <!-- Segundo paso Parte 3-->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="3" data-title="Tercer Paso">
                      <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                      <div class="col-sm-1 col1Body"> 
                        <span class="step">1</span>
                        <span class="step activePass">2</span>
                        <span class="step">3</span>
                      </div>
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Características del Bien</h4>                
                        <label>Campos marcados con * son obligatorios.</label>
                          
                          <div class="form-group">
                              <select class="form-control" value="{{=bien['bm_material']}}" type="select" id="material" name="material" placeholder="Material predominante" onchange="agregar_otro_mat()" required>
                                <!-- Insertar un for-->
                                <option type="text" value="">Selecione un material*</option>
                                {{ for material in material_pred: }}
                                    <option value="{{=material}}">{{=material}}</option>
                                {{pass}}
                              </select>
                              <div class="field-error"> <p id="error-material"> </p> </div>
                          </div>

                        <div class="form-group">
                            {{ if bien['bm_material'] in material_pred: }}
                                <input type="hidden" class="form-control" id="otro_material" placeholder="Material*" required>
                            {{ else: }}
                                <input type="text" class="form-control" id="otro_material" value="{{=bien['bm_material']}}" placeholder="Material*" required>
                            {{ pass }}
                            <div class="field-error"> <p id="error-material"> </p> </div>
                        </div>

                          <div class="form-group">
                              <select class="form-control" type="select" id="color" name="color" placeholder="Color" onchange="agregar_otro_color()" required>
                                <option value="">Selecione un color*</option>
                                {{ for color in color_list:}}
                                    <option value="{{=color}}">{{=color}}</option>                                
                                {{pass}}
                              </select>
                              <div class="field-error"> <p id="error-color"> </p> </div>
                          </div>

                        <div class="form-group">
                            {{ if bien['bm_color'] in color_list: }}
                                <input type="hidden" class="form-control" id="otro_color" placeholder="Color*" required>
                            {{ else: }}
                                <input type="text" class="form-control" value="{{=bien['bm_color']}}" id="otro_color" placeholder="Color*" required>
                            {{ pass }}
                            <div class="field-error"> <p id="error-color"> </p> </div>
                        </div>

                          <label>Dimensiones</label>

                          <div class="form-group">
                                <select class="form-control" value="" type="select" id="unidad" name="unidad" placeholder="Unidad de medida" onchange="display_units(this.value)">
                                <option value="">Selecione una unidad</option>
                                {{ for med in unidad_med:}}
                                    {{if bien['bm_unidad']==med:}}
                                        <option value="{{=med}}" selected="selected" >{{=med}}</option>
                                    {{else:}}
                                        <option value="{{=med}}">{{=med}}</option>
                                    {{pass}}
                                {{pass}}
                                </select>
                            <div class="field-error"> <p id="error-unidad" > </p> </div>
                          </div>

                          <!-- FALTA ARREGLAR ESTO  -->
                           {{if bien['bm_unidad']=="" or bien['bm_unidad']==None:}}   
                              <div class="form-group">
                                    <input type="hidden" class="form-control" id="ancho" name="ancho" title="Formato ##.##" placeholder="Ancho">
                                <font color="red"><div id="err_ancho" hidden></div></font>
                              </div>

                              <div class="form-group">
                                    <input type="hidden" class="form-control" id="largo" name="largo" title="Formato ##.##" placeholder="Largo" >
                                <font color="red"><div id="err_largo" hidden></div></font>
                              </div>

                              <div class="form-group">
                                    <input type="hidden" class="form-control" id="alto" name="alto" title="Formato ##.##" placeholder="Altura" >
                                <font color="red"><div id="err_alto" hidden></div></font>
                              </div>

                              <div class="form-group">
                                    <input type="hidden" class="form-control" id="diametro" name="diametro" title="Formato ##.##" placeholder="Diámetro" >
                                <font color="red"><div id="err_diametro" hidden></div></font>
                              </div>

                            {{elif bien['bm_unidad']!=None or bien['bm_unidad']!="":}}
                                <div class="form-group">
                                {{if bien['bm_ancho']==None:}}
                                    <input type="text" class="form-control" id="ancho" name="ancho" title="Formato ##.##" placeholder="Ancho">
                                {{else:}}
                                    <input type="text" class="form-control" value="{{=bien['bm_ancho']}}" id="ancho" name="ancho" title="Formato ##.##" placeholder="Ancho">
                                {{pass}}
                                <font color="red"><div id="err_ancho" hidden></div></font>
                              </div>

                              <div class="form-group">
                                
                                {{if bien['bm_largo']==None:}}
                                    <input type="text" class="form-control" id="largo" name="largo" title="Formato ##.##" placeholder="Largo" >
                                {{else:}}
                                    <input type="text" class="form-control" id="largo" value="{{=bien['bm_largo']}}" name="largo" title="Formato ##.##" placeholder="Largo" >
                                {{pass}}
                                <font color="red"><div id="err_largo" hidden></div></font>
                              </div>

                              <div class="form-group">
                                
                                {{if bien['bm_alto']==None:}}
                                    <input type="text" class="form-control" id="alto" name="alto" title="Formato ##.##" placeholder="Altura" >
                                {{else:}}
                                    <input type="text" class="form-control" id="alto" value="{{=bien['bm_alto']}}" name="alto" title="Formato ##.##" placeholder="Altura" >
                                {{pass}}
                                <font color="red"><div id="err_alto" hidden></div></font>
                              </div>

                              <div class="form-group">
                                
                                {{if bien['bm_diametro']==None:}}
                                    <input type="text" class="form-control" id="diametro" name="diametro" title="Formato ##.##" placeholder="Diámetro" >
                                {{else:}}
                                    <input type="text" class="form-control" id="diametro" value="{{=bien['bm_diametro']}}" name="diametro" title="Formato ##.##" placeholder="Diámetro" >
                                {{pass}}
                                <font color="red"><div id="err_diametro" hidden></div></font>
                              </div>
                            {{pass}}
                        </div>
                      </div>
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="button" class="btn btn-next botonForm"><i class="fas fa-arrow-right"></i></button>       
                  </fieldset>
                  <!-- Fin Segundo Paso -->


                <!--Segundo Paso parte 2-->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="3" data-title="Tercer Paso">
                      <!-- Barra lateral gris (vacia en este caso, pues no hay pasos) -->
                      <div class="col-sm-1 col1Body"> 
                        <span class="step">1</span>
                        <span class="step activePass">2</span>
                        <span class="step">3</span>
                      </div>
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Características del Bien</h4>                
                        <label>Campos marcados con * son obligatorios.</label>
                        
                        <div class="form-group">
                            <label>Seleccione un tipo de movilidad*</label>
                            <select class="form-control" type="select" id="movilidad" value="{{=bien['bm_movilidad']}}" name="movilidad" placeholder="Movilidad" required>
                              <option value="">Seleccione un tipo de movilidad</option>
                              {{ for movilidad in movilidad_list: }}
                                {{if bien['bm_movilidad']==movilidad:}}
                                    <option value="{{=movilidad}}" selected="selected">{{=movilidad}}</option>
                                {{else:}}
                                    <option value="{{=movilidad}}">{{=movilidad}}</option>
                                {{pass}}
                              {{pass}}
                            </select>
                            <div class="field-error"> <p id="error-movilidad"> </p> </div>
                        </div>

                        <label>Tipo de Uso</label>
                        <font color="red"><div id="err_tipo_uso" hidden></div></font>
                        <div class="checkbox-group">
                        {{i=1}}
                        {{ for uso in uso_list: }}
                            {{if uso in bien['bm_uso']:}}
                                <input type="checkbox" name="tipo_uso" id="tipo_uso{{=i}}" value="{{=uso}}" checked>{{=uso}}
                            {{else:}}
                                <input type="checkbox" name="tipo_uso" id="tipo_uso{{=i}}" value="{{=uso}}">{{=uso}}
                            {{pass}}
                            {{i = i+1}} 
                          <br>
                        {{pass}}

                        </div>

                        {{if bien['bm_calibrar']!="":}}
                        <div class="form-group" id="calibrar">
                          <label>Seleccione si el equipo ha sido calibrado*</label>
                          <select class="form-control" id="select-calibrar" type="select" name="calibrar" placeholder="Calibración" onchange="display_date(this.value)">
                            <option value="">Seleccione una opción</option>
                                {{if bien['bm_calibrar']=="Si":}}
                                    <option value="Si" selected="selected">Si</option>
                                {{else:}}
                                    <option value="Si">Si</option>
                                {{pass}}
                            
                                {{if bien['bm_calibrar']=="No":}}
                                    <option value="No" selected="selected">No</option>
                                {{else:}}
                                    <option value="No">No</option>
                                {{pass}}
                            
                          </select>
                          <div class="field-error"> <p id="error-calibrar"> </p> </div>
                        </div>
                        {{pass}}

                        {{if bien['bm_calibrar']=="No" or bien['bm_calibrar']=="":}}
                        <div class="form-group" id="fecha_calibracion" style="display: none">
                          <label>Seleccione la fecha de la última calibración del equipo*</label>
                            {{if bien['bm_fecha_calibracion']=="":}}
                                <input type="date" class="form-control" name="fecha_calibracion">
                            {{else:}}
                                <input type="date" class="form-control" value="{{=bien['bm_fecha_calibracion']}}" name="fecha_calibracion">
                            {{pass}}
                          
                          <div class="field-error"> <p id="error-fecha_calibracion"></p></div>
                        </div>
                        {{elif bien['bm_calibrar']=="Si":}}
                        <div class="form-group" id="fecha_calibracion" >
                          <label>Seleccione la fecha de la última calibración del equipo*</label>
                            {{if bien['bm_fecha_calibracion']=="":}}
                                <input type="date" class="form-control" name="fecha_calibracion">
                            {{else:}}
                                <input type="date" class="form-control" value="{{=bien['bm_fecha_calibracion']}}" name="fecha_calibracion">
                            {{pass}}
                          
                          <div class="field-error"> <p id="error-fecha_calibracion"></p></div>
                        </div>
                        {{pass}}
  
                        <div class="form-group">
                          <label>Seleccione el estado del bien mueble*</label>
                          <select class="form-control" type="select" id="estatus" value="{{=bien['bm_estatus']}}" name="estatus" placeholder="Estatus del equipo" required>
                            <option value="">Seleccione una opción</option>
                            {{ form_estatus = ['Operativo','Inoperativo','En desuso','Inservible'] }}
                            {{ for estatus in form_estatus: }}
                                {{if bien['bm_estatus']==estatus:}}
                                    <option value="{{=estatus}}" selected="selected">{{=estatus}}</option>
                                {{else:}}
                                    <option value="{{=estatus}}">{{=estatus}}</option>
                                {{pass}}
                            {{pass}}
                          </select>
                          <div class="field-error"> <p id="error-estatus"> </p> </div>
                        </div>

                        </div>
                      </div>

                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="button" class="btn btn-next botonForm" onclick="colocar_subcategoria2(0);"><i class="fas fa-arrow-right"></i></button>       
                  </fieldset>
                  <!-- Fin segundo paso-->

                <!-- Comienzo Tercer Paso Parte 1-->
                <fieldset class="formField">
                    <div class="form-bottom" data-step="4" data-title="Cuarto Paso">
                      <!-- Aqui va la barra lateral -->
                      <div class="col-sm-1 col1Body">
                        <span class="step">1</span>
                        <span class="step">2</span>
                        <span class="step activePass">3</span>
                      </div>
  
                      <!-- Aqui va la informacion -->
                      <div class="col-sm-11 col11Body" style="padding-top: 50px">
                      <h4 class="titulosForm">SUDEBID</h4>
                      <label>Importante: llene según requerimientos de SUDEBID</label>
                        
                      <div class="form-group">
                          <label class="form-group" id="numRegistro" style="margin-bottom: 0px" >Ubicación</label>
                          <select class="form-control" type="select" value="{{=bien['bm_localizacion']}}" value="" id="localizacion" onchange="placeholder_localizacion(this.value);"  name="localizacion" required>
                            <option value="" onchange="placeholder_localizacion(this.value);">Seleccione una localizacion</option>
                            {{for cod in localizacion:}}
                                {{if bien['bm_localizacion']==cod:}}
                                    <option value="{{=cod}}" selected="selected" onchange="placeholder_localizacion(this.value);">{{=cod}}</option>
                                {{else:}}
                                    <option value="{{=cod}}" onchange="placeholder_localizacion(this.value);">{{=cod}}</option>
                                {{pass}}
                            {{pass}}
                          </select>
                          <div class="field-error"> <p id="error-cod-localizacion"> </p> </div>
                        </div>

                        <div class="form-group">
                            <label class="form-group" id="numRegistro" style="margin-bottom: 0px">Código de localización</label>
                            <input type="text" class="form-control" value="{{=bien['bm_codigo_localizacion']}}" id="cod_loc" name="cod_loc" placeholder="" readonly >
                            <div class="field-error"> <p id="error-cod_loc"> </p> </div>
                          </div>
                  

                      <div class="form-group">
                          <label class="form-group" id="numRegistro" style="margin-bottom: 0px">Categorias</label>
                          <select class="form-control" type="select" value="{{=bien['bm_categoria']}}" id="categoria" onchange="colocar_subcategoria2(2);" name="nombre_cat" required>
                            <option value="" onchange="colocar_subcategoria2(2);" >Seleccione una categorias</option>
                            {{ for categoria in nombre_cat:}}
                                {{if bien['bm_categoria']==categoria:}}
                                    <option value="{{=categoria}}" selected="selected" onchange="colocar_subcategoria2(2);" >{{=categoria}}</option>
                                {{else:}}
                                    <option value="{{=categoria}}" onchange="colocar_subcategoria2(2);" >{{=categoria}}</option>
                                {{pass}}
                            {{pass}}

                          </select>
                          <div class="field-error"> <p id="error-categorias"> </p> </div>
                        </div>

                    
                        <div class="form-group">
                            <label class="form-group" id="numRegistro" style="margin-bottom: 0px">Subcategorias</label>
                            <label class="form-group" id="numRegistro2" style="margin-bottom: 0px" ></label>
                            <select class="form-control" onchange="colocar_subcategoria2(1);" type="select" value="{{=bien['bm_subcategoria']}}" id="Subcategorias"  name="subcategoria" required>
                              <option value="{{=bien['bm_subcategoria']}}" id='Opcion0'>{{=bien['bm_subcategoria']}}</option>
                              <option value="" id="Opcion1" hidden></option>
                              <option value="" id="Opcion2" hidden ></option>
                              <option value="" id="Opcion3" hidden ></option>
                              <option value="" id="Opcion4" hidden ></option>
                              <option value="" id="Opcion5" hidden ></option>
                              <option value="" id="Opcion6" hidden ></option>
                              <option value="" id="Opcion7" hidden ></option>
                              <option value="" id="Opcion8" hidden ></option>
                              <option value="" id="Opcion9" hidden ></option>
                            </select>
                            <div class="field-error"> <p id="error-categorias"> </p> </div>
                        </div>

                      </div>
                    </div>
                    <button type="button" class="btn btn-previous botonForm"><i class="fas fa-arrow-left"></i></button>
                    <button type="submit button" form="formularioCarga" id="submit" name="modificacion" value="True" class="btn btn-submit botonForm"><i class="fas fa-pencil-alt"></i></button>
                </fieldset>
                <!-- Fin Tercer Paso -->
              </form>
          </div>
        </div>               
      </div>
    </div>
  </div>
</div>

<!-- Fin Modal Agregar BM -->


<script type="text/javascript">

    // Funcion para seleccionar valores de los select
    function select_values(){
        // selecciono valor del select de materiales
        var material = document.getElementById("material");
        var otro_material = document.getElementById("otro_material")
        var value = "{{=bien['bm_material']}}"
        var material_bool = "{{=bien['bm_material'] in material_pred}}"
        if ( material_bool == "True"){
            material.value = value;
        }else{
            material.removeAttribute("name");
            otro_material.setAttribute("name","material");
            material.value = "Otro"
        }
        //selecciono el valor del select de colores
        var material = document.getElementById("color");
        var otro_color = document.getElementById("otro_color")
        var value = "{{=bien['bm_color']}}"
        var color_bool = "{{=bien['bm_color'] in color_list}}"
        if ( color_bool == "True"){
            color.value = value;
        }else{
            color.removeAttribute("name");
            otro_color.setAttribute("name","color");
            color.value = "Otro color"
        }
    }

    // Funcion para agregar otro material
    function agregar_otro_mat(){
        var material = document.getElementById("material")
        var otro_material = document.getElementById("otro_material")
        if ( material.value === "Otro" ){
        material.removeAttribute("name");
        otro_material.setAttribute("name","material");
        otro_material.type =  "text";
        }else{
        otro_material.removeAttribute("name");
        otro_material.type = "hidden";
        material.setAttribute("name","material");
        }
    }

    // Funcion para agregar otro color
    function agregar_otro_color(){
        var color = document.getElementById("color")
        var otro_color = document.getElementById("otro_color")

        if ( color.value === "Otro color" ){
        color.removeAttribute("name");
        otro_color.setAttribute("name","color");
        otro_color.type =  "text";
        }else{
        otro_color.removeAttribute("name");
        otro_color.type = "hidden";
        color.setAttribute("name","color");
        }
    }

    // Funcion para mostrar campos dependendiendo de la categoria
    function elegir_campos(){
      var selecion = "{{=bien['bm_clasificacion']}} ";
      if (selecion.value == "Mobiliario"){
        document.getElementById("marca").type = 'hidden';
        document.getElementById("modelo").type = 'hidden';
        document.getElementById("serial").type = 'hidden';
        document.getElementById("estatus").type = 'hidden';
        document.getElementById("calibrar").style.display = 'none';
      }
      else{
        document.getElementById("select-calibrar").setAttribute("required", "");
        document.getElementById("marca").type = 'text';
        document.getElementById("modelo").type = 'text';
        document.getElementById("serial").type = 'text';
        document.getElementById("estatus").type = 'text';
        document.getElementById("calibrar").style.display = 'block';
      }
      document.getElementById("fecha_calibracion").style.display = 'none';
    }
  
    // Mostrar fecha de calibracion
    function display_date(value){
      if ( value == "Si" ){
        document.getElementById("fecha_calibracion").style.display = 'block';
        document.getElementById("fecha_calibracion").setAttribute("required", "");
      }else{
        document.getElementById("fecha_calibracion").style.display = 'none';
      }
    }
  
    // Mostrar unidades
    function display_units(value){
      if ( value == '' ){
        document.getElementById("unidad").type = 'hidden';
        document.getElementById("ancho").type = 'hidden';
        document.getElementById("largo").type = 'hidden';
        document.getElementById("alto").type = 'hidden';
        document.getElementById("diametro").type = 'hidden';
      }else{
        document.getElementById("unidad").type = 'text';
        document.getElementById("ancho").type = 'text';
        document.getElementById("largo").type = 'text';
        document.getElementById("alto").type = 'text';
        document.getElementById("diametro").type = 'text';
      }
    }
  
    // Valida los campos de la forma en el modal "addbm"
    function validar_campos(){
  
      // Buscando divs para ingresar mensajes de error
      var error_total = document.getElementById("error-total");
      var error_uso_interno = document.getElementById("error-uso-interno");
      var fecha_calibracion = document.getElementById("fecha_calibracion")
  
      // Limpiando los mensajes <i class="fas fa-arrow-left"></i>es de validadores
      if (error_total.innerText != ''){
        error_total.innerText = '';
      }
      if (error_uso_interno.innerText != ''){
        error_uso_interno.innerText = '';
      }
       
      // Buscando los valores ingresados por el usuario en cada campo
      var total = document.forms['formularioCarga']['total'].value;
      var uso_interno = document.forms['formularioCarga']['uso_interno'].value;
  
      // Mensajes de error
      var mensaje_error_tipo = "Por favor ingrese un valor numérico. Por ejemplo \"2.5\"";
      var mensaje_error_negativo = "Por favor ingrese un valor no negativo.";
      var mensaje_error_nulo = "Por favor ingrese un valor mayor a cero.";
      var mensaje_error_uso_interno = "Por favor ingrese un valor inferior o igual a la cantidad en existencia.";
  
      /* Validando el campo total (cantidad total de la sustancia en el inventario) */
      if (!is_number(total)) {
        error_total.innerText = mensaje_error_tipo;
        return false;
      }
      
      if (is_negative(total)) {
        error_total.innerText = mensaje_error_negativo;
        return false;
      }
  
      if (is_zero(total)) {
        error_total.innerText = mensaje_error_nulo;
        return false;
      }
  
      /* Validando el campo uso_interno */
      if (!is_number(uso_interno)) {
        error_uso_interno.innerText = mensaje_error_tipo;
        return false;
      }
      
      if (is_negative(uso_interno)) {
        error_uso_interno.innerText = mensaje_error_negativo;
        return false;
      }
      // La cantidad de sustancia para uso interno no puede ser mayor al total
      if (uso_interno > total) {
        error_uso_interno.innerText = mensaje_error_uso_interno;
        return false;
      }
  
    }
  
    // True si "n" es un numero
    function is_number(n){
      return !isNaN(n);
    }
  
    // True si "n" es negativo
    function is_negative(n){
      return (n < 0)
    }
  
    // True si "n" es cero
    function is_zero(n){
      return (n == 0)
    }
  
    function placeholder_localizacion(value){
      var x = document.getElementById("cod_loc");
      var y = document.getElementById("localizacion");
  
  
      if (value  =='Edo Miranda, Municipio Baruta, Parroquia Baruta'){
        x.placeholder = '150301';
        x.value = '150301';
      }else{;
        x.placeholder ='240107';
        x.value = '240107';
  
      }
    }

    function colocar_subcategoria2(indicador){
    value = document.getElementById('categoria').value;
      var dict = {
          'Maquinaria Construcción':
              ["Maquinaria y equipos de construcción y mantenimiento",
              "Maquinarias y equipos para mantenimiento de automotores",
              "Maquinarias y equipos agrícolas y pecuarios",
              "Maquinarias y equipos de artes gráficas y reproducción",
              "Maquinarias y equipos industriales y de taller",
              "Maquinarias y equipos de energía",
              "Maquinarias y equipos de riego y acueductos",
              "Equipos de almacen",
              "Otras maquinarias y demás equipos de construcción, campo, industria y taller"],
          "Equipo Transporte":
              ["Vehículos automotores terrestres",
              "Equipos ferroviarios y de cables aéreos",
              "Equipos marítimos de transporte",
              "Equipos aéreos de transporte",
              "Vehículos de tracción no motorizados",
              "Equipos auxiliares de transporte",
              "Otros equipos de transporte, tracción y elevación"],
          "Equipo Comunicaciones":
              ["Equipos de telecomunicaciones",
              "Equipos de señalamiento",
              "Equipos de control de tráfico aéreo",
              "Equipos de correo",
              "Otros equipos de comunicaciones y de señalamiento"],
          "Equipo Médico":
              ["Equipos médicos - quirúrgicos, dentales y veterinarios",
              "Otros Equipos médicos - quirúrgicos, dentales y veterinarios"],
          "Equipo Científico Religioso":
              ["Equipos científicos y de laboratorio",
              "Equipos de enseñanza, deporte y recreación",
              "Obras de arte",
              "Libros y revistas",
              "Equipos religiosos",
              "Instrumentos musicales",
              "Otros equipos científicos, religiosos, de enseñanza y recreación"],
          "Equipo Oficina" : 
              ["Mobiliario y equipos de oficina",
              "Equipos de procesamiento de datos",
              "Mobiliario y equipos de alojamiento",
              "Otras máquinas, muebles y demás equipos de oficina y de alojamiento"]};
    var n = 1;
    var x;
    var y = document.getElementById("numRegistro2");
  
    if (indicador == '1' || indicador == '2'){
        var z = document.getElementById('Opcion0');
        z.value = '';
        z.innerHTML = 'Seleccione una opcion';
        if (indicador == '2'){
            z.selected = true;
        }
    }

    if (value != ""){
      for (var i in dict[value]){
        x = document.getElementById("Opcion".concat(n.toString()));
        x.innerText = dict[value][i];
        x.style.display= "block";
        $('#Opcion'.concat(n.toString())).html(dict[value][i]);
        $('#Opcion'.concat(n.toString())).show();
        x.value = dict[value][i];
        n = n + 1;  
      }
      while (n <= 9){
        x = document.getElementById("Opcion".concat(n.toString()));
        //x.innerText = "";
        //x.style.display = "none";
        $('#Opcion'.concat(n.toString())).hide();
        $('#Opcion'.concat(n.toString())).html("");
        x.value = "";
        n = n +1;
        
      }
      
    }
  }
  </script>
  <script type="text/javascript">
    $('.tab-link').click( function() {
        
        var tabID = $(this).attr('data-tab');
        
        $(this).addClass('active').siblings().removeClass('active');
        
        $('#tab-'+tabID).addClass('active').siblings().removeClass('active');
    });
      
      </script>
  {{end}}